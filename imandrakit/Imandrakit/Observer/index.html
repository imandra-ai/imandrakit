<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Observer (imandrakit.Imandrakit.Observer)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta name="generator" content="odoc 2.4.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">imandrakit</a> &#x00BB; <a href="../index.html">Imandrakit</a> &#x00BB; Observer</nav><header class="odoc-preamble"><h1>Module <code><span>Imandrakit.Observer</span></code></h1><p>Observer, to subscribe to some events.</p><p>The observer is thread-safe. However, it is recommended that <code>subscribe</code> callbacks either run in a very short time, or queue heavier work on some background <code>Executor_sig.S</code>.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p>Observer of events of type <code>'a</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-emit"><a href="#val-emit" class="anchor"></a><code><span><span class="keyword">val</span> emit : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-emit_lazy"><a href="#val-emit_lazy" class="anchor"></a><code><span><span class="keyword">val</span> emit_lazy : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>emit_lazy obs f</code> emits the result of <code>f()</code>, but only calls <code>f()</code> if there's at least one observer to be notified.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-handle"><a href="#type-handle" class="anchor"></a><code><span><span class="keyword">type</span> handle</span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Unsubscribe"><a href="#exception-Unsubscribe" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Unsubscribe</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-subscribe"><a href="#val-subscribe" class="anchor"></a><code><span><span class="keyword">val</span> subscribe : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-handle">handle</a></span></code></div><div class="spec-doc"><p>Subscribe to the events. The callback can raise <code>Unsubscribe</code> to remove itself.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-subscribe'"><a href="#val-subscribe'" class="anchor"></a><code><span><span class="keyword">val</span> subscribe' : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Subscribe to the events. The callback can raise <code>Unsubscribe</code> to remove itself.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unsubscribe"><a href="#val-unsubscribe" class="anchor"></a><code><span><span class="keyword">val</span> unsubscribe : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-n_subscribers"><a href="#val-n_subscribers" class="anchor"></a><code><span><span class="keyword">val</span> n_subscribers : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Current number of subscribers</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-has_subscribers"><a href="#val-has_subscribers" class="anchor"></a><code><span><span class="keyword">val</span> has_subscribers : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Is there any subscriber?</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-forward"><a href="#val-forward" class="anchor"></a><code><span><span class="keyword">val</span> forward : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>forward o1 o2</code> subscribes to <code>o1</code> and forwards all events to <code>o2</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_subscribe"><a href="#val-with_subscribe" class="anchor"></a><code><span><span class="keyword">val</span> with_subscribe : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'ret</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'ret</span></span></code></div><div class="spec-doc"><p><code>with_subscribe obs cb f</code> subscribes <code>cb</code> to <code>obs</code>, calls <code>f()</code>, and when <code>f()</code> is done or has raised, it unsubscribes <code>cb</code>.</p></div></div></div></body></html>
